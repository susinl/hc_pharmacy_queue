<?php
	function status_bar($s_id){
		if($s_id == 10){
			echo
			'<span class="w3-tag w3-round-large w3-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-fire" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
		if($s_id == 11){
			echo
			'<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-fire" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
		if($s_id == 12){
			echo
			'<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-fire" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
		if($s_id == 13 | $s_id == 14){
			echo
			'<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="width: 60px;"><i class="fa fa-fire" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
		if($s_id == 15 | $s_id == 16){
			echo
			'<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-fire" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-red w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
		if($s_id == 20 | $s_id == 30){
			echo
			'<span class="w3-tag w3-round-large w3-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-white w3-center" style="width: 60px;"></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-white w3-center" style="width: 60px;"></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
		if($s_id == 21 | $s_id == 22 | $s_id == 31){
			echo
			'<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-white w3-center" style="width: 60px;"></span>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-white w3-center" style="width: 60px;"></span>
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
		if($s_id == 23 | $s_id == 24 | $s_id == 32 | $s_id ==33){
			echo
			'<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-white w3-center" style="width: 60px;"></span>
        	<span class="w3-tag w3-round-large w3-light-blue w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span>
        	<span class="w3-tag w3-round-large w3-white w3-center" style="width: 60px;"></span>
        	<span class="w3-tag w3-round-large w3-red w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span>';
		}
	}

	function type_process_icon($t_id){
		if($t_id == 1){
			echo
			'<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span> รอจัดยา
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-balance-scale" aria-hidden="true"></i></span> จัดยา
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span> รอต้มยา
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-fire" aria-hidden="true"></i></span> ต้มยา
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span> เสร็จ';
		}
		if($t_id == 2 | $t_id == 3){
			echo
			'<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span> รอจัดยา
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-clock-o" aria-hidden="true"></i></span> จัดยา
        	<span class="w3-tag w3-round-large w3-light-grey w3-center" style="width: 60px;"><i class="fa fa-check-circle" aria-hidden="true"></i></span> เสร็จ';
        }
	}
		function type_process($t_id){
		if($t_id == 1){
			echo
			'<span class="w3-tag w3-round-large w3-blue w3-center" style="font-size: 110%;"> รอจัดยา<br> Queuing </span> <i class="fa fa-arrow-right" aria-hidden="true"></i>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="font-size: 110%;"> จัดยา<br> Preparing </span> <i class="fa fa-arrow-right" aria-hidden="true"></i>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="font-size: 110%;"> รอต้มยา<br> Queuing </span> <i class="fa fa-arrow-right" aria-hidden="true"></i>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="font-size: 110%;"> ต้มยา<br> Decocting </span> <i class="fa fa-arrow-right" aria-hidden="true"></i>
        	<span class="w3-tag w3-round-large w3-blue w3-center" style="font-size: 110%;"> เสร็จ<br> Finished </span> ';
		}
		if($t_id == 2 | $t_id == 3){
			echo
			'<span class="w3-tag w3-round-large w3-red w3-center" style="font-size: 110%;"> รอจัดยา<br> Queuing </span> <i class="fa fa-arrow-right" aria-hidden="true"></i>
        	<span class="w3-tag w3-round-large w3-red w3-center" style="font-size: 110%;"> จัดยา<br> Preparing </span> <i class="fa fa-arrow-right" aria-hidden="true"></i>
        	<span class="w3-tag w3-round-large w3-red w3-center" style="font-size: 110%;"> เสร็จ<br> Finished </span> ';
        }
	}

	

		function finish_table_3c($db, $fin_s_id, $fin, $today, $title){ 
			// ใช้แสดงคิวที่เสร็จแล้ว ต้องใส่ค่อ 
			//$fin_s_id ซึ่งคือ id ที่แปลว่าพร้อมจ่ายยา, $title เป็นชื่อหัวข้อของตาราง, $today เป็นวันที่อยู่ใน format 'yyyy-mm-dd'
            // การทำงาน
            // 1. เลือกใบยาที่เสร็จแล้วออกมาจากระบบ
            // 2. ดึงแถวแรกออกมาแล้วเช็คว่าเป็นใบยาที่ต้องแสดงไหมจาก array ของยิม
            // 3. ดูว่าเสร็จทุกใบจริง ๆ แล้วยัง
            // 4. ถ้าเสร็จทุกใบแล้ว เอาไปพิมพ์ลงตาราง
            // 5. กลับไปเริ่มใหม่ที่ข้อ 2
        	//1.
        	$query1 = "SELECT p.pre_id, p.q_id, q.q_name 
						FROM ieproject.dbo.prescription as p, ieproject.dbo.queue as q 
						WHERE p.q_id = q.q_id 
						AND p.in_datetime > '$today'
						AND p.in_datetime <= dateadd(day, 1, '$today') 
						AND p.s_id = '$fin_s_id' 
							ORDER BY p.q_id;";
        	$result = odbc_exec($db, $query1);
    	
         	// เขียนเรื่องให้มันไปอีกหน้าถ้าล้น
    		$item = 1; //ตอนนี้กำลังจะพิมพ์ตัวที่ item ใน 1 แถวจะมี 3 ตัว ใน 1 หน้ามี 12 ตัว

        	while ($list = odbc_fetch_array($result)){ //ดึงแถวแรกออกมา
        		$pre_id = $list['pre_id'];
        		$q_id = $list['q_id'];
        		$q_name = $list['q_name'];
        		//2.
        		//if(in_array($pre_id, $fin)){

            		//3.Check if there is any prescription with the same q_id that isn't finished.
            		$finished_all = 1;
            		$s_id_finish = array(15, 16, 23, 24, 32, 33, 40); //finish status
            		$query2 = "SELECT * FROM prescription where q_id = '$q_id';";
            		$result2 = odbc_exec($db, $query2);
            		while ($list2 = odbc_fetch_array($result2)) {
            			$check_s_id = $list2['s_id']; //ดูว่า s_id ของใบยาอื่น ๆ เสร็จหรือยัง
            			if (!in_array($check_s_id, $s_id_finish)){
            				$finished_all = 0;
            			}
            		}

            		//4.
            		if($finished_all==1){ //if all is finish
            			$mod3 = $item%3;
            			$mod12 = $item%12;
            			if($mod12 == 1 && $item != 1){ //ขึ้นหน้าใหม่ถ้าตัวต่อไปที่จะพิมพ์ ถ้า mod12 = 1 ก็คืเอเป็นตัวแรกของหน้า
		        			// ปิด table, div ที่เป็น slide
		        			echo 	"	</table>
		        					</div>";
		        			echo 	
		        			'<div class="w3-animate-right mySlides3c">
		            			<table class="w3-table w3-striped-red" style="font-size:80px!important">';
		        		}
            			
            			if($mod3 == 1){//ตัวแรกของแถว
            				echo "<tr><td><b>".$q_name."</b></td>";
            				$item++;
            			}
            			if($mod3 == 2){//ตัวที่สองของแถว
            				echo "<td><b>".$q_name."</b></td>";
            				$item++;
            			}
            			if($mod3 == 0){
            				echo "<td><b>".$q_name."</b></td></tr>";
            				$item++;
            			}
            		}
            	//}
        	}

       		//พิพม์ครบแล้วต้องเช็คว่าอยู่ตัวที่เท่าไหร่จะได้ปิดตารางได้ครบ
        	$mod3 = $item%3;
        	if($mod3 == 1){ //ถ้าจะพิมพ์ตัวที่ 1 ของแถว ไม่ต้องปิดตารางเพราะเพิ่งปิดไป
			}
			else if($mod3 == 2){//เพิ่งพิมพ์ตัวแรกไปต้องพิมพ์อีก 2 ตัวเพื่อปิด
				echo "<td></td><td></td></tr>";
			}
			else if($mod3 == 0){ //พิมพ์ไปแล้ว 2 ตัวกำลังจะพิมพ์ตัวที่ 3 ดังนั้นต้องเอาอีก 1 ตัวแล้วค่อยปิด
				echo "<td></td></tr>";
			}
		}

		function finish_table_2c($db, $fin_s_id, $fin, $today, $title){ 
			// ใช้แสดงคิวที่เสร็จแล้ว ต้องใส่ค่อ 
			//$fin_s_id ซึ่งคือ id ที่แปลว่าพร้อมจ่ายยา, $title เป็นชื่อหัวข้อของตาราง, $today เป็นวันที่อยู่ใน format 'yyyy-mm-dd'
            // การทำงาน
            // 1. เลือกใบยาที่เสร็จแล้วออกมาจากระบบ
            // 2. ดึงแถวแรกออกมาแล้วเช็คว่าเป็นใบยาที่ต้องแสดงไหมจาก array ของยิม
            // 3. ดูว่าเสร็จทุกใบจริง ๆ แล้วยัง
            // 4. ถ้าเสร็จทุกใบแล้ว เอาไปพิมพ์ลงตาราง
            // 5. กลับไปเริ่มใหม่ที่ข้อ 2
        	//1.
        	$query1 = "SELECT p.pre_id, p.q_id, q.q_name 
						FROM ieproject.dbo.prescription as p, ieproject.dbo.queue as q 
						WHERE p.q_id = q.q_id 
						AND p.in_datetime > '$today'
						AND p.in_datetime <= dateadd(day, 1, '$today') 
						AND p.s_id = '$fin_s_id' 
							ORDER BY p.q_id;";
        	$result = odbc_exec($db, $query1);
    	
         	// เขียนเรื่องให้มันไปอีกหน้าถ้าล้น
    		$item = 1; //ตอนนี้กำลังจะพิมพ์ตัวที่ item ใน 1 แถวจะมี 2 ตัว ใน 1 หน้ามี 8 ตัว

        	while ($list = odbc_fetch_array($result)){ //ดึงแถวแรกออกมา
        		$pre_id = $list['pre_id'];
        		$q_id = $list['q_id'];
        		$q_name = $list['q_name'];
        		//2.
        		//if(in_array($pre_id, $fin)){

            		//3.Check if there is any prescription with the same q_id that isn't finished.
            		$finished_all = 1;
            		$s_id_finish = array(15, 16, 23, 24, 32, 33, 40); //finish status
            		$query2 = "SELECT * FROM prescription where q_id = '$q_id';";
            		$result2 = odbc_exec($db, $query2);
            		while ($list2 = odbc_fetch_array($result2)) {
            			$check_s_id = $list2['s_id']; //ดูว่า s_id ของใบยาอื่น ๆ เสร็จหรือยัง
            			if (!in_array($check_s_id, $s_id_finish)){
            				$finished_all = 0;
            			}
            		}

            		//4.
            		if($finished_all==1){ //if all is finish
            			$mod2 = $item%2;
            			$mod8 = $item%8;
            			if($mod8 == 1 && $item != 1){ //ขึ้นหน้าใหม่ถ้าตัวต่อไปที่จะพิมพ์ ถ้า mod8 = 1 ก็คืเอเป็นตัวแรกของหน้า
		        			// ปิด table, div ที่เป็น slide
		        			echo 	"	</table>
		        					</div>";
		        			echo 	
		        			'<div class="w3-animate-right mySlides2c">
		            			<table class="w3-table w3-striped-red" style="font-size:80px!important">';
		        		}
            			
            			if($mod2 == 1){//ตัวแรกของแถว
            				echo "<tr><td><b>".$q_name."</b></td>";
            				$item++;
            			}
            			if($mod2 == 0){
            				echo "<td><b>".$q_name."</b></td></tr>";
            				$item++;
            			}
            		}
            	//}
        	}

       		//พิพม์ครบแล้วต้องเช็คว่าอยู่ตัวที่เท่าไหร่จะได้ปิดตารางได้ครบ
        	$mod2 = $item%2;
        	if($mod2 == 1){ //ถ้าจะพิมพ์ตัวที่ 1 ของแถว ไม่ต้องปิดตารางเพราะเพิ่งปิดไป
			}
			else if($mod2 == 0){ //พิมพ์ไปแล้ว 1 ตัวกำลังจะพิมพ์ตัวที่ 2 ดังนั้นต้องเอาอีก 1 ตัวแล้วค่อยปิด
				echo "<td></td></tr>";
			}
		}

		function finish_table_1c($db, $fin_s_id, $fin, $today, $title){ 
			// ใช้แสดงคิวที่เสร็จแล้ว ต้องใส่ค่อ 
			//$fin_s_id ซึ่งคือ id ที่แปลว่าพร้อมจ่ายยา, $title เป็นชื่อหัวข้อของตาราง, $today เป็นวันที่อยู่ใน format 'yyyy-mm-dd'
            // การทำงาน
            // 1. เลือกใบยาที่เสร็จแล้วออกมาจากระบบ
            // 2. ดึงแถวแรกออกมาแล้วเช็คว่าเป็นใบยาที่ต้องแสดงไหมจาก array ของยิม
            // 3. ดูว่าเสร็จทุกใบจริง ๆ แล้วยัง
            // 4. ถ้าเสร็จทุกใบแล้ว เอาไปพิมพ์ลงตาราง
            // 5. กลับไปเริ่มใหม่ที่ข้อ 2
        	//1.
        	$query1 = "SELECT p.pre_id, p.q_id, q.q_name 
						FROM ieproject.dbo.prescription as p, ieproject.dbo.queue as q 
						WHERE p.q_id = q.q_id 
						AND p.in_datetime > '$today'
						AND p.in_datetime <= dateadd(day, 1, '$today') 
						AND p.s_id = '$fin_s_id' 
							ORDER BY p.q_id;";
        	$result = odbc_exec($db, $query1);
    	
         	// เขียนเรื่องให้มันไปอีกหน้าถ้าล้น
    		$item = 1; //ตอนนี้กำลังจะพิมพ์ตัวที่ item ใน 1 แถวจะมี 2 ตัว ใน 1 หน้ามี 4 ตัว

        	while ($list = odbc_fetch_array($result)){ //ดึงแถวแรกออกมา
        		$pre_id = $list['pre_id'];
        		$q_id = $list['q_id'];
        		$q_name = $list['q_name'];
        		//2.
        		//if(in_array($pre_id, $fin)){

            		//3.Check if there is any prescription with the same q_id that isn't finished.
            		$finished_all = 1;
            		$s_id_finish = array(15, 16, 23, 24, 32, 33, 40); //finish status
            		$query2 = "SELECT * FROM prescription where q_id = '$q_id';";
            		$result2 = odbc_exec($db, $query2);
            		while ($list2 = odbc_fetch_array($result2)) {
            			$check_s_id = $list2['s_id']; //ดูว่า s_id ของใบยาอื่น ๆ เสร็จหรือยัง
            			if (!in_array($check_s_id, $s_id_finish)){
            				$finished_all = 0;
            			}
            		}

            		//4.
            		if($finished_all==1){ //if all is finish
            			$mod1 = 0;
            			$mod4 = $item%4;
            			if($mod4 == 1 && $item != 1){ //ขึ้นหน้าใหม่ถ้าตัวต่อไปที่จะพิมพ์ ถ้า mod4 = 1 ก็คืเอเป็นตัวแรกของหน้า
		        			// ปิด table, div ที่เป็น slide
		        			echo 	"	</table>
		        					</div>";
		        			echo 	
		        			'<div class="w3-animate-right mySlides1c">
		            			<table class="w3-table w3-striped-red" style="font-size:80px!important">';
		        		}
            			
            			
            			if($mod1 == 0){
            				echo "<tr><td><b>".$q_name."</b></td>";
            				$item++;
            			}
            		}
            	//}
        	}

       		//พิพม์ครบแล้วต้องเช็คว่าอยู่ตัวที่เท่าไหร่จะได้ปิดตารางได้ครบ
        	$mod1 = 0;
        	if($mod1 == 0){ //พิมพ์ไปแล้ว 1 ตัวกำลังจะพิมพ์ตัวที่ 2 ดังนั้นต้องเอาอีก 1 ตัวแล้วค่อยปิด
				echo "<td></td></tr>";
			}
		}
//////////////////////////////
//////////////////////////////
	function display_status($db, $fin_s_id, $collected_s_id, $cancle_s_id, $t_id, $title, $today, $language) {
		$query1 = "SELECT p.pre_id, p.q_id, q.q_name, p.finishtime, p.s_id, s.s_display_thai, s.s_display, p.in_datetime, p.t_id
					FROM ieproject.dbo.prescription as p, ieproject.dbo.queue as q, status as s
					WHERE p.q_id = q.q_id 
					AND p.s_id = s.s_id
					AND p.in_datetime > '$today'
					AND p.in_datetime <= dateadd(day, 1, '$today') 
					AND p.s_id != '$fin_s_id'
					AND p.s_id != '$collected_s_id'
					AND p.s_id != '$cancle_s_id'
					AND p.t_id = '$t_id'
						ORDER BY p.q_id;";
    	$result = odbc_exec($db, $query1);
     	// เขียนเรื่องให้มันไปอีกหน้าถ้าล้น
		$item = 1; //ตอนนี้กำลังจะพิมพ์ตัวที่ item ใน 1 แถวจะมี 3 ตัว ใน 1 หน้ามี 18 ตัว
    	while ($list = odbc_fetch_array($result)){ //ดึงแถวแรกออกมา
    		$pre_id = $list['pre_id'];
    		$q_id = $list['q_id'];
    		$q_name = $list['q_name'];
    		$finishtime = $list['finishtime'];
    		$in_datetime = $list['in_datetime'];
    		$t_id = $list['t_id'];
    		$s_id = $list['s_id'];
    		$s_display = $list['s_display'];
    		$s_display_thai = iconv('TIS-620', 'UTF-8', $list['s_display_thai']);
			// $s_display_thai = $list['s_display_thai'];
            $fin_time_display = round(strtotime($finishtime) / 300) * 300; //ปัดเป็น 5 นาที
            // $fin_time_display = round(strtotime($finishtime) / 600) * 600; //ปัดเป็น 10 นาที
    		//2.
    		//if(in_array($pre_id, $wip)){
        		//3.ถ้าเป็นตัวที่ขึ้นหน้าใหม่ ปิดตาราง div และขึ้น div ใหม่
    			$mod5 = $item%5;
    			if($mod5 == 1 && $item != 1){ //ขึ้นหน้าใหม่ถ้าตัวต่อไปที่จะพิมพ์ ถ้า mod5 = 1 ก็คืเอเป็นตัวแรกของหน้า
        			// ปิด table, div ที่เป็น slide
        			echo 	"	</table>
        					</div>";
        			// เปิด div เขียนชนิดยา เปิดตาราง และหัวข้อ
        			echo 	
        			'<div class="w3-animate-right mySlidesWIP1">
						<h1 class="w3-center w3-jumbo w3-blue" style="font-size:3vw!important">'.$title.'</h1>
						<h2 class="w3-center">';
        			type_process($t_id);
        			echo '</h2>
						<table class="w3-table w3-center w3-padding w3-striped-blue w3-xxxlarge">
	                        <tr class="w3-blue w3-jumbo">
							<th style="width:25%">คิว</th>
                            <th style="width:35%">เสร็จเวลา</th>
                            <th style="width:30%">สถานะ</th>
                            <th style="width:10%"></th>
                        </tr>';
        		}

    			//4.พิมพ์ยาตัวนี้
    			//าษาอังกฤษ
    			// if($language == "eng"){
    			// 	$in_time = strtotime($in_datetime);
	    		// 	if ($in_time >= strtotime('14:30:00') && $t_id ==1){
	    		// 		$s_display = "Next day";
	    		// 	}
	    		// 	echo 
	    		// 	'<tr>
	            //         <th style="font-size:150%">'.$q_name.'</th>
	            //         <td style="font-size:150%">'.date('H:i', $fin_time_display).'</td>
	            //         <td class="w3-border-left" style="font-size:50%;">'.$s_display.'</td>
	            //     </tr>
	    		// 	';
                //     $item++;
    			// }
    			if($language == "th"){
	    			$in_time = strtotime($in_datetime);
                    $next_day=0;
	    			if ($in_time >= strtotime('14:31:00') && $t_id ==1){
	    				$s_display_thai = "รับพรุ่งนี้";
						$next_day = 1;
						$s_display = "Next day";
	    			}
	    			if($next_day == 1){
	    			echo 
	    			'<tr>
	                    <th style="font-size:150%">'.$q_name.'</th>
	                    <td></td>
	                    <td style="font-size:150%">'.$s_display_thai.'</td>
						<td class="w3-border-left" style="font-size:50%;">'.$s_display.'</td>
	                </tr>
	    			';
	    			}
                    else if ($fin_time_display >= strtotime('16:30:00'))
                    {
						$s_display_thai = "รับพรุ่งนี้";
						$s_display = "Next day";
                        echo 
                        '<tr>
                            <th style="font-size:150%">'.$q_name.'</th>
                            <td></td>
							<td style="font-size:150%">'.$s_display_thai.'</td>
							<td class="w3-border-left" style="font-size:50%;">'.$s_display.'</td>
                        </tr>
                        ';
                    }else if ($s_id == 103)
                    {
						$s_display_thai = "รับพรุ่งนี้";
						$s_display = "Next day";
                        echo 
                        '<tr>
                            <th style="font-size:150%">'.$q_name.'</th>
                            <td></td>
							<td style="font-size:150%">'.$s_display_thai.'</td>
							<td class="w3-border-left" style="font-size:50%;">'.$s_display.'</td>
                        </tr>
                        ';
                    }
	    			else{
					if($s_display == "Picking"){$s_display = "Preparing";}
					if($s_display == "Wait to pick"){$s_display = "Wait to prepare";}
	    			echo 
	    			'<tr>
	                    <th style="font-size:150%">'.$q_name.'</th>
	                    <td style="font-size:150%">'.date('H:i', $fin_time_display).'</td>
	                    <td style="font-size:150%">'.$s_display_thai.'</td>
						<td class="w3-border-left" style="font-size:50%;">'.$s_display.'</td>
	                </tr>
	    			';
	    			}
	    			$item++;
    			}
        	//}
		}
    }

	function display_status2($db, $fin_s_id, $collected_s_id, $cancle_s_id, $t_id, $title, $today, $language) {
		$query1 = "SELECT p.pre_id, p.q_id, q.q_name, p.finishtime, p.s_id, s.s_display_thai, s.s_display, p.in_datetime, p.t_id
					FROM ieproject.dbo.prescription as p, ieproject.dbo.queue as q, status as s
					WHERE p.q_id = q.q_id 
					AND p.s_id = s.s_id
					AND p.in_datetime > '$today'
					AND p.in_datetime <= dateadd(day, 1, '$today') 
					AND p.s_id != '$fin_s_id'
					AND p.s_id != '$collected_s_id'
					AND p.s_id != '$cancle_s_id'
					AND p.t_id = '$t_id'
						ORDER BY p.q_id;";
    	$result = odbc_exec($db, $query1);
     	// เขียนเรื่องให้มันไปอีกหน้าถ้าล้น
		$item = 1; //ตอนนี้กำลังจะพิมพ์ตัวที่ item ใน 1 แถวจะมี 3 ตัว ใน 1 หน้ามี 18 ตัว
    	while ($list = odbc_fetch_array($result)){ //ดึงแถวแรกออกมา
    		$pre_id = $list['pre_id'];
    		$q_id = $list['q_id'];
    		$q_name = $list['q_name'];
    		$finishtime = $list['finishtime'];
    		$in_datetime = $list['in_datetime'];
    		$t_id = $list['t_id'];
    		$s_id = $list['s_id'];
    		$s_display = $list['s_display'];
    		$s_display_thai = iconv('TIS-620', 'UTF-8', $list['s_display_thai']);
    		// $s_display_thai = $list['s_display_thai'];
			$s_display = $list['s_display'];
            $fin_time_display = round(strtotime($finishtime) / 300) * 300; //ปัดเป็น 5 นาที
            // $fin_time_display = round(strtotime($finishtime) / 600) * 600; //ปัดเป็น 10 นาที
    		//2.
    		//if(in_array($pre_id, $wip)){
        		//3.ถ้าเป็นตัวที่ขึ้นหน้าใหม่ ปิดตาราง div และขึ้น div ใหม่
    			$mod5 = $item%5;
    			if($mod5 == 1 && $item != 1){ //ขึ้นหน้าใหม่ถ้าตัวต่อไปที่จะพิมพ์ ถ้า mod5 = 1 ก็คืเอเป็นตัวแรกของหน้า
        			// ปิด table, div ที่เป็น slide
        			echo 	"	</table>
        					</div>";
        			// เปิด div เขียนชนิดยา เปิดตาราง และหัวข้อ
        			echo 	
        			'<div class="w3-animate-right mySlidesWIP2">
						<h1 class="w3-center w3-jumbo w3-red" style="font-size:3vw!important">'.$title.'</h1>
						<h2 class="w3-center">';
        			type_process($t_id);
        			echo '</h2>
						<table class="w3-table w3-center w3-padding w3-striped-red w3-xxxlarge">
	                        <tr class="w3-red w3-jumbo">
							<th style="width:25%">คิว</th>
                            <th style="width:35%">เสร็จเวลา</th>
                            <th style="width:30%">สถานะ</th>
                            <th style="width:10%"></th>
                        </tr>';
        		}

    			//4.พิมพ์ยาตัวนี้
    			//าษาอังกฤษ
    			// if($language == "eng"){
    			// 	$in_time = strtotime($in_datetime);
	    		// 	if ($in_time >= strtotime('14:30:00') && $t_id ==1){
	    		// 		$s_display = "Next day";
	    		// 	}
	    		// 	echo 
	    		// 	'<tr>
	            //         <th style="font-size:150%">'.$q_name.'</th>
	            //         <td style="font-size:150%">'.date('H:i', $fin_time_display).'</td>
	            //         <td>'.$s_display.$s_display.'</td>
	            //     </tr>
	    		// 	';
                //     $item++;
				// }
    			if($language == "th"){
	    			$in_time = strtotime($in_datetime);
                    $next_day=0;
	    			if ($in_time >= strtotime('14:31:00') || ($fin_time_display >= strtotime('16:25:00'))){
	    				echo 
						'<tr>
							<th style="font-size:150%">'.$q_name.'</th>
							<td style="font-size:150%">16:25</td>
							<td style="font-size:150%">'.$s_display_thai.'</td>
							<td class="w3-border-left" style="font-size:50%;">'.$s_display.'</td>
						</tr>
	    			';
	    			}
                    else{
					if($s_display == "Picking"){$s_display = "Preparing";}
					if($s_display == "Wait to pick"){$s_display = "Wait to prepare";}
	    			echo 
	    			'<tr>
	                    <th style="font-size:150%">'.$q_name.'</th>
	                    <td style="font-size:150%">'.date('H:i', $fin_time_display).'</td>
	                    <td style="font-size:150%">'.$s_display_thai.'</td>
						<td class="w3-border-left" style="font-size:50%;">'.$s_display.'</td>
	                </tr>
	    			';
	    			}
	    			$item++;
    			}
        	//}
		}
    }

?>
